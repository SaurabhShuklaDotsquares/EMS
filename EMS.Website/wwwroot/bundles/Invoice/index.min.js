(function(n){function t(){function u(){return{FromDate:n("#txt_From").val(),ToDate:n("#txt_To").val(),BAId:parseInt(n("#ddl_BaList").val()),TLId:parseInt(n("#ddl_TlList").val()),Name:n("#txt_search").val()}}function i(){n(".divoverlay").removeClass("hide");t=new Global.GridHelper("#grid-invoice",{serverSide:!0,destroy:!0,pageLength:50,bLengthChange:!1,ordering:!1,bFilter:!1,bAutoWidth:!1,dom:"Bfrtip",buttons:["excel"],ajax:{url:domain+"Invoice/Index",type:"Post",data:u()},order:[[0,"desc"]],columnDefs:[{width:"12%",targets:0},{width:"22%",targets:1},{width:"8%",targets:2},{width:"10%",targets:3,className:"text-center"},{width:"15%",targets:4},{width:"7%",targets:5,className:"text-right"},{width:"10%",targets:6,className:"text-center"},{width:"5%",targets:7,className:"text-center"},],columns:[{name:"CRMProjectId",data:"crmProjectId",title:"Client",sortable:!1,searchable:!1,visible:!0,render:function(n,t,i){return"CRM ID:["+i.crmProjectId+"]<br>"+i.clientName}},{name:"ProjectName",data:"projectName",title:"Project Name",sortable:!1,searchable:!1,visible:!0,render:function(n,t,i){return i.projectName+"<br><span style='font-size:11px'>Last Activity<\/span>: "+i.lastActivity}},{name:"InvoiceNumber",data:"invoiceNumber",title:"Invoice Number",sortable:!1,searchable:!1,visible:!0},{name:"InvoiceDate",data:"invoiceDate",title:"Date",sortable:!1,searchable:!1,visible:!0,render:function(n,t,i){return i.invoiceStartDate+" /<br>"+i.invoiceEndDate}},{name:"BAName",data:"baName",title:"BA Name",sortable:!1,searchable:!1,visible:!0},{name:"TLName",data:"tlName",title:"TL Name",sortable:!1,searchable:!1,visible:!0},{name:"InvoiceStatus",title:"Status",sortable:!1,searchable:!1,visible:!0,render:function(n,t,i){return' <a class="ablue" href="'+domain+"Invoice/InvoiceStatus?InvoiceId="+i.id+'" data-toggle="modal" data-target="#modal-invoiceStatus"> '+i.invoiceStatus+" <\/a>"}},{name:"Action",data:null,title:"Action",sortable:!1,searchable:!1,render:function(n,t,i){var r="";return i.showChaseIcon&&(r+='<a data-toggle="modal" title="chase" data-target="#modal-chaseInvoice" href="'+domain+"Invoice/ChaseInvoice?Id="+i.id+'"><i class="fa fa-share blue" style="color:black"><\/i><\/a>&nbsp;&nbsp;'),r+='<a data-toggle="modal" title="view detail" data-target="#modal-ViewInvoice" href="'+domain+"Invoice/ViewInvoice?Id="+i.id+'" ><i class="fa fa-eye blue"  style="color:black"><\/i><\/a>&nbsp;&nbsp;',i.showDelete&&(r+='<a data-toggle="modal"  title="add/edit" data-target="#modal-AddEditInvoice" href="'+domain+"Invoice/AddEditInvoice?Id="+i.id+'" ><i class="fa fa-pencil blue"  style="color:black"><\/i><\/a>&nbsp;&nbsp;',r+='<a data-toggle="modal" title="delete" data-target="#modal-deleteInvoice" href="'+domain+"Invoice/CancelInvoice?Id="+i.id+'"><i class="fa fa-trash blue"  style="color:black"><\/i><\/a>'),r}}],fnRowCallback:function(t,i){n(t).addClass(i.cssClass)},fnDrawCallback:function(t){n(".divoverlay").addClass("hide");t.fnRecordsDisplay()>0?n("#btnExcel").show():n("#btnExcel").hide();t._iDisplayLength>t.fnRecordsDisplay()?n(".dataTables_paginate").hide():n(".dataTables_paginate").show();n(".pagination .active a").css("background-color","#e99701");n(".pagination .active a").css("border-color","#e99701")}})}function f(){n("#CustomSearch").click(function(){i()});n("#btn_reset").click(function(){n("#txt_search").val("");n("#txt_From").val("");n("#txt_To").val("");n("#ddl_BaList").val("");n("#ddl_TlList").val("");i()});n("#txt_From").datepicker({dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0});n("#txt_To").datepicker({dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0})}function e(){n("#modal-AddEditInvoice").on("loaded.bs.modal",function(){var r=n(this),i=new Global.FormHelper(r.find("form"),{updateTargetId:"validation-summary",validateSettings:{ignore:""}},null,function(n){n.isSuccess?(t.ajax.reload(),r.modal("hide"),Global.ShowMessage(n.message,!0,"validation-summary")):Global.ShowMessage(n.message||n.errorMessage||n,!1,"MessageDiv")});i.on("keypress keyup blur",".decimal-number",function(t){n(this).val(n(this).val().replace(/[^0-9\.]/g,""));(t.which!=46||n(this).val().indexOf(".")!=-1)&&(t.which<48||t.which>57)&&t.preventDefault()});i.find("#StartDate").datepicker({dateFormat:"dd/mm/yy",onSelect:function(n){i.find("#EndDate").datepicker("option","minDate",n)}});i.find("#EndDate").datepicker({dateFormat:"dd/mm/yy",onSelect:function(n){i.find("#StartDate").datepicker("option","maxDate",n)}})}).on("hidden.bs.modal",function(){n(this).removeData("bs.modal");n(this).find(".modal-content").empty()});n("#modal-invoiceStatus").on("loaded.bs.modal",function(){var i=n(this),r=new Global.FormHelper(i.find("form"),{updateTargetId:"validation-summary",validateSettings:{ignore:"disabled"}},null,function(n){n.isSuccess?(t.ajax.reload(),i.modal("hide"),Global.ShowMessage(n.message,!0,"validation-summary")):Global.ShowMessage(n.message||n.errorMessage||n,!1,"MessageDiv")});r.on("change","#InvoiceStatusId",function(){n("#InvoiceStatusId").val()=="2"?(n(".remainamnt").removeClass("hide"),n(".remainamnt #RemainingAmount").attr("disabled",!1)):(n(".remainamnt").addClass("hide"),n(".remainamnt #RemainingAmount").attr("disabled",!0))});r.on("keypress keyup blur",".decimal-number",function(t){n(this).val(n(this).val().replace(/[^0-9\.]/g,""));(t.which!=46||n(this).val().indexOf(".")!=-1)&&(t.which<48||t.which>57)&&t.preventDefault()})}).on("hidden.bs.modal",function(){n(this).removeData("bs.modal");n(this).find(".modal-content").empty()});n("#modal-deleteInvoice").on("loaded.bs.modal",function(){var i=n("#modal-deleteInvoice"),r=new Global.FormHelper(n(this).find("form"),{updateTargetId:"validation-summary",validateSettings:{ignore:""}},null,function(n){n.isSuccess?(t.ajax.reload(),i.modal("hide"),Global.ShowMessage(n.message,!0,"validation-summary")):Global.ShowMessage(n.message||n.errorMessage||n,!1,"MessageDiv")})}).on("hidden.bs.modal",function(){n(this).removeData("bs.modal");n(this).find(".modal-content").empty()})}var t,r=this;r.init=function(){i();f();e()}}n(function(){var n=new t;n.init()})})(jQuery);